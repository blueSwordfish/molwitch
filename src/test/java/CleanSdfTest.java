/*
 * NCATS-MOLWITCH
 *
 * Copyright 2020 NIH/NCATS
 *
 *    Licensed under the Apache License, Version 2.0 (the "License");
 *    you may not use this file except in compliance with the License.
 *    You may obtain a copy of the License at
 *
 *        http://www.apache.org/licenses/LICENSE-2.0
 *
 *    Unless required by applicable law or agreed to in writing, software
 *    distributed under the License is distributed on an "AS IS" BASIS,
 *    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *    See the License for the specific language governing permissions and
 *    limitations under the License.
 */

import gov.nih.ncats.molwitch.io.CtTableCleaner;
import org.junit.Test;

import java.io.*;

import static org.junit.Assert.assertEquals;

public class CleanSdfTest {

    @Test
    public void oneRecordWith2LinesBetweenConnectionTableAndProperties() throws IOException {
        String sdf = "Untitled Document\n" +
                "  ChemDraw05101917272D\n" +
                "\n" +
                " 51 55  0  0  0  0  0  0  0  0999 V2000\n" +
                "    5.7158   -1.6500    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    5.0013   -2.0625    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    4.2868   -1.6500    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    3.5724   -2.0625    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    2.8579   -1.6500    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    2.1434   -2.0625    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    1.4289   -1.6500    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.7145   -2.0625    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.0000   -1.6500    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.0000   -2.4750    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.7145   -2.0625    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -1.4289   -1.6500    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -1.4289   -0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -2.1434   -0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -2.1434    0.4125    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -2.8579   -0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -3.5724   -0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -4.2868   -0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -4.2868   -1.6500    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -3.5724   -2.0625    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -2.8579   -1.6500    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -2.1434   -2.0625    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -2.1434   -2.8875    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -3.5724   -2.8875    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -5.0013   -2.0625    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -5.7158   -1.6500    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -5.7158   -0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -5.0013   -0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -5.0013    0.4125    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -5.7158    0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -3.5724    0.4125    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.7145   -0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.7145    0.4125    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.0000    0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.7145    0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    1.4289    0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    2.1434    0.4125    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    2.8579    0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    3.5724    0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    3.5724   -0.4125    0.0000 F   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    4.2868    0.0000    0.0000 F   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    4.2868    0.8250    0.0000 F   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    2.8579    1.6500    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    1.4289    1.6500    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    2.1434    2.0625    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.7145    2.0625    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.7145    2.8875    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.0000    1.6500    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.0000   -0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.7145   -2.8875    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    2.8579   -0.8250    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "  1  2  1  0      \n" +
                "  2  3  1  0      \n" +
                "  3  4  1  0      \n" +
                "  4  5  1  0      \n" +
                "  5  6  1  0      \n" +
                "  6  7  1  0      \n" +
                "  7  8  1  0      \n" +
                "  8  9  1  0      \n" +
                "  9 10  1  1      \n" +
                "  9 11  1  0      \n" +
                " 11 12  1  0      \n" +
                " 12 13  2  0      \n" +
                " 13 14  1  0      \n" +
                " 14 15  1  0      \n" +
                " 14 16  2  0      \n" +
                " 16 17  1  0      \n" +
                " 17 18  1  0      \n" +
                " 18 19  2  0      \n" +
                " 19 20  1  0      \n" +
                " 20 21  1  0      \n" +
                " 16 21  1  0      \n" +
                " 21 22  2  0      \n" +
                " 12 22  1  0      \n" +
                " 22 23  1  0      \n" +
                " 20 24  2  0      \n" +
                " 19 25  1  0      \n" +
                " 25 26  2  0      \n" +
                " 26 27  1  0      \n" +
                " 27 28  2  0      \n" +
                " 18 28  1  0      \n" +
                " 28 29  1  0      \n" +
                " 29 30  1  0      \n" +
                " 17 31  2  0      \n" +
                " 13 32  1  0      \n" +
                " 32 33  1  1      \n" +
                " 34 33  1  6      \n" +
                " 34 35  1  0      \n" +
                " 35 36  1  0      \n" +
                " 36 37  1  1      \n" +
                " 37 38  1  0      \n" +
                " 38 39  1  0      \n" +
                " 39 40  1  0      \n" +
                " 39 41  1  0      \n" +
                " 39 42  1  0      \n" +
                " 38 43  2  0      \n" +
                " 36 44  1  0      \n" +
                " 44 45  1  1      \n" +
                " 44 46  1  0      \n" +
                " 46 47  1  1      \n" +
                " 46 48  1  0      \n" +
                " 34 48  1  0      \n" +
                " 32 49  1  0      \n" +
                "  9 49  1  0      \n" +
                "  8 50  2  0      \n" +
                "  5 51  2  0      \n" +
                "M  END\n" +
                "\n" +
                "\n" +
                ">  <RackCode>\n" +
                "HYCPK4191\n" +
                "\n" +
                ">  <Cat. No.>\n" +
                "HY-13772\n" +
                "\n" +
                ">  <Product Name>\n" +
                "Valrubicin\n" +
                "\n" +
                ">  <ROW>\n" +
                "A\n" +
                "\n" +
                ">  <COLUMN>\n" +
                "1\n" +
                "\n" +
                ">  <VialCode>\n" +
                "000003UJT\n" +
                "\n" +
                ">  <CAS No.>\n" +
                "56124-62-0\n" +
                ">  <Target>\n" +
                "PKC\n" +
                "\n" +
                ">  <Saltdata>\n" +
                "Free Base\n" +
                "\n" +
                ">  <Information>\n" +
                "Valrubicin is a chemotherapy agent, inhibits TPA- and PDBu-induced PKC activation with IC50s of 0.85 and 1.25 ¶ÃM, respectively, and has antitumor and antiinflammatory activity.\n" +
                "\n" +
                ">  <Smiles>\n" +
                "CCCCC(OCC([C@]1(O)CC2=C(C(O)=C3C(C4=C(C(C3=C2O)=O)C=CC=C4OC)=O)[C@@H](O[C@H]5C[C@H](NC(C(F)(F)F)=O)[C@H](O)[C@H](C)O5)C1)=O)=O\n" +
                "\n" +
                ">  <Solubility>\n" +
                "DMSO : °› 130 mg/mL (179.65 mM); H2O : < 0.1 mg/mL (insoluble)\n" +
                "\n" +
                ">  <Solvent>\n" +
                "EtOH\n" +
                "\n" +
                ">  <Batch No.>\n" +
                "34233\n" +
                "\n" +
                ">  <Quantity>\n" +
                "0.010000000\n" +
                "\n" +
                ">  <URL>\n" +
                "https://www.medchemexpress.com/Valrubicin.html\n" +
                "\n" +
                ">  <Pathway>\n" +
                "Epigenetics; TGF-beta/Smad\n" +
                "\n" +
                ">  <SUPPLIER>\n" +
                "MedChemExpress\n"+
                "$$$$"
                ;

        String expected = "Untitled Document\n" +
                "  ChemDraw05101917272D\n" +
                "\n" +
                " 51 55  0  0  0  0  0  0  0  0999 V2000\n" +
                "    5.7158   -1.6500    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    5.0013   -2.0625    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    4.2868   -1.6500    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    3.5724   -2.0625    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    2.8579   -1.6500    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    2.1434   -2.0625    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    1.4289   -1.6500    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.7145   -2.0625    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.0000   -1.6500    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.0000   -2.4750    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.7145   -2.0625    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -1.4289   -1.6500    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -1.4289   -0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -2.1434   -0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -2.1434    0.4125    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -2.8579   -0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -3.5724   -0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -4.2868   -0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -4.2868   -1.6500    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -3.5724   -2.0625    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -2.8579   -1.6500    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -2.1434   -2.0625    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -2.1434   -2.8875    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -3.5724   -2.8875    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -5.0013   -2.0625    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -5.7158   -1.6500    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -5.7158   -0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -5.0013   -0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -5.0013    0.4125    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -5.7158    0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -3.5724    0.4125    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.7145   -0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.7145    0.4125    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.0000    0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.7145    0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    1.4289    0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    2.1434    0.4125    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    2.8579    0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    3.5724    0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    3.5724   -0.4125    0.0000 F   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    4.2868    0.0000    0.0000 F   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    4.2868    0.8250    0.0000 F   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    2.8579    1.6500    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    1.4289    1.6500    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    2.1434    2.0625    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.7145    2.0625    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.7145    2.8875    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.0000    1.6500    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.0000   -0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.7145   -2.8875    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    2.8579   -0.8250    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "  1  2  1  0      \n" +
                "  2  3  1  0      \n" +
                "  3  4  1  0      \n" +
                "  4  5  1  0      \n" +
                "  5  6  1  0      \n" +
                "  6  7  1  0      \n" +
                "  7  8  1  0      \n" +
                "  8  9  1  0      \n" +
                "  9 10  1  1      \n" +
                "  9 11  1  0      \n" +
                " 11 12  1  0      \n" +
                " 12 13  2  0      \n" +
                " 13 14  1  0      \n" +
                " 14 15  1  0      \n" +
                " 14 16  2  0      \n" +
                " 16 17  1  0      \n" +
                " 17 18  1  0      \n" +
                " 18 19  2  0      \n" +
                " 19 20  1  0      \n" +
                " 20 21  1  0      \n" +
                " 16 21  1  0      \n" +
                " 21 22  2  0      \n" +
                " 12 22  1  0      \n" +
                " 22 23  1  0      \n" +
                " 20 24  2  0      \n" +
                " 19 25  1  0      \n" +
                " 25 26  2  0      \n" +
                " 26 27  1  0      \n" +
                " 27 28  2  0      \n" +
                " 18 28  1  0      \n" +
                " 28 29  1  0      \n" +
                " 29 30  1  0      \n" +
                " 17 31  2  0      \n" +
                " 13 32  1  0      \n" +
                " 32 33  1  1      \n" +
                " 34 33  1  6      \n" +
                " 34 35  1  0      \n" +
                " 35 36  1  0      \n" +
                " 36 37  1  1      \n" +
                " 37 38  1  0      \n" +
                " 38 39  1  0      \n" +
                " 39 40  1  0      \n" +
                " 39 41  1  0      \n" +
                " 39 42  1  0      \n" +
                " 38 43  2  0      \n" +
                " 36 44  1  0      \n" +
                " 44 45  1  1      \n" +
                " 44 46  1  0      \n" +
                " 46 47  1  1      \n" +
                " 46 48  1  0      \n" +
                " 34 48  1  0      \n" +
                " 32 49  1  0      \n" +
                "  9 49  1  0      \n" +
                "  8 50  2  0      \n" +
                "  5 51  2  0      \n" +
                "M  END\n" +  //<--- no extra blank lines  here in cleaned version
                ">  <RackCode>\n" +
                "HYCPK4191\n" +
                "\n" +
                ">  <Cat. No.>\n" +
                "HY-13772\n" +
                "\n" +
                ">  <Product Name>\n" +
                "Valrubicin\n" +
                "\n" +
                ">  <ROW>\n" +
                "A\n" +
                "\n" +
                ">  <COLUMN>\n" +
                "1\n" +
                "\n" +
                ">  <VialCode>\n" +
                "000003UJT\n" +
                "\n" +
                ">  <CAS No.>\n" +
                "56124-62-0\n" +
                ">  <Target>\n" +
                "PKC\n" +
                "\n" +
                ">  <Saltdata>\n" +
                "Free Base\n" +
                "\n" +
                ">  <Information>\n" +
                "Valrubicin is a chemotherapy agent, inhibits TPA- and PDBu-induced PKC activation with IC50s of 0.85 and 1.25 ¶ÃM, respectively, and has antitumor and antiinflammatory activity.\n" +
                "\n" +
                ">  <Smiles>\n" +
                "CCCCC(OCC([C@]1(O)CC2=C(C(O)=C3C(C4=C(C(C3=C2O)=O)C=CC=C4OC)=O)[C@@H](O[C@H]5C[C@H](NC(C(F)(F)F)=O)[C@H](O)[C@H](C)O5)C1)=O)=O\n" +
                "\n" +
                ">  <Solubility>\n" +
                "DMSO : °› 130 mg/mL (179.65 mM); H2O : < 0.1 mg/mL (insoluble)\n" +
                "\n" +
                ">  <Solvent>\n" +
                "EtOH\n" +
                "\n" +
                ">  <Batch No.>\n" +
                "34233\n" +
                "\n" +
                ">  <Quantity>\n" +
                "0.010000000\n" +
                "\n" +
                ">  <URL>\n" +
                "https://www.medchemexpress.com/Valrubicin.html\n" +
                "\n" +
                ">  <Pathway>\n" +
                "Epigenetics; TGF-beta/Smad\n" +
                "\n" +
                ">  <SUPPLIER>\n" +
                "MedChemExpress\n"+
                "$$$$"
                ;


         assertCleanedCorrectly(expected, sdf);


    }

    private void assertCleanedCorrectly(String expected, String uncleaned) throws IOException {
//        StringWriter actual = new StringWriter(uncleaned.length());
//        try(BufferedReader reader = new BufferedReader(new StringReader(uncleaned));
//            BufferedWriter writer = new BufferedWriter(actual);
//        ) {
//            SdfUtil.copyClean(reader, writer);
//        }
//
        assertEquals(expected, CtTableCleaner.clean(uncleaned));
    }

    @Test
    public void twoRecordWith2LinesBetweenConnectionTableAndProperties() throws IOException {

        String sdf ="Untitled Document\n" +
                "  ChemDraw05101917272D\n" +
                "\n" +
                " 51 55  0  0  0  0  0  0  0  0999 V2000\n" +
                "    5.7158   -1.6500    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    5.0013   -2.0625    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    4.2868   -1.6500    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    3.5724   -2.0625    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    2.8579   -1.6500    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    2.1434   -2.0625    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    1.4289   -1.6500    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.7145   -2.0625    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.0000   -1.6500    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.0000   -2.4750    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.7145   -2.0625    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -1.4289   -1.6500    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -1.4289   -0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -2.1434   -0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -2.1434    0.4125    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -2.8579   -0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -3.5724   -0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -4.2868   -0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -4.2868   -1.6500    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -3.5724   -2.0625    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -2.8579   -1.6500    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -2.1434   -2.0625    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -2.1434   -2.8875    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -3.5724   -2.8875    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -5.0013   -2.0625    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -5.7158   -1.6500    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -5.7158   -0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -5.0013   -0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -5.0013    0.4125    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -5.7158    0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -3.5724    0.4125    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.7145   -0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.7145    0.4125    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.0000    0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.7145    0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    1.4289    0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    2.1434    0.4125    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    2.8579    0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    3.5724    0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    3.5724   -0.4125    0.0000 F   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    4.2868    0.0000    0.0000 F   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    4.2868    0.8250    0.0000 F   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    2.8579    1.6500    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    1.4289    1.6500    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    2.1434    2.0625    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.7145    2.0625    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.7145    2.8875    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.0000    1.6500    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.0000   -0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.7145   -2.8875    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    2.8579   -0.8250    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "  1  2  1  0      \n" +
                "  2  3  1  0      \n" +
                "  3  4  1  0      \n" +
                "  4  5  1  0      \n" +
                "  5  6  1  0      \n" +
                "  6  7  1  0      \n" +
                "  7  8  1  0      \n" +
                "  8  9  1  0      \n" +
                "  9 10  1  1      \n" +
                "  9 11  1  0      \n" +
                " 11 12  1  0      \n" +
                " 12 13  2  0      \n" +
                " 13 14  1  0      \n" +
                " 14 15  1  0      \n" +
                " 14 16  2  0      \n" +
                " 16 17  1  0      \n" +
                " 17 18  1  0      \n" +
                " 18 19  2  0      \n" +
                " 19 20  1  0      \n" +
                " 20 21  1  0      \n" +
                " 16 21  1  0      \n" +
                " 21 22  2  0      \n" +
                " 12 22  1  0      \n" +
                " 22 23  1  0      \n" +
                " 20 24  2  0      \n" +
                " 19 25  1  0      \n" +
                " 25 26  2  0      \n" +
                " 26 27  1  0      \n" +
                " 27 28  2  0      \n" +
                " 18 28  1  0      \n" +
                " 28 29  1  0      \n" +
                " 29 30  1  0      \n" +
                " 17 31  2  0      \n" +
                " 13 32  1  0      \n" +
                " 32 33  1  1      \n" +
                " 34 33  1  6      \n" +
                " 34 35  1  0      \n" +
                " 35 36  1  0      \n" +
                " 36 37  1  1      \n" +
                " 37 38  1  0      \n" +
                " 38 39  1  0      \n" +
                " 39 40  1  0      \n" +
                " 39 41  1  0      \n" +
                " 39 42  1  0      \n" +
                " 38 43  2  0      \n" +
                " 36 44  1  0      \n" +
                " 44 45  1  1      \n" +
                " 44 46  1  0      \n" +
                " 46 47  1  1      \n" +
                " 46 48  1  0      \n" +
                " 34 48  1  0      \n" +
                " 32 49  1  0      \n" +
                "  9 49  1  0      \n" +
                "  8 50  2  0      \n" +
                "  5 51  2  0      \n" +
                "M  END\n" +
                "\n" +
                "\n" +
                ">  <RackCode>\n" +
                "HYCPK4191\n" +
                "\n" +
                ">  <Cat. No.>\n" +
                "HY-13772\n" +
                "\n" +
                ">  <Product Name>\n" +
                "Valrubicin\n" +
                "\n" +
                ">  <ROW>\n" +
                "A\n" +
                "\n" +
                ">  <COLUMN>\n" +
                "1\n" +
                "\n" +
                ">  <VialCode>\n" +
                "000003UJT\n" +
                "\n" +
                ">  <CAS No.>\n" +
                "56124-62-0\n" +
                ">  <Target>\n" +
                "PKC\n" +
                "\n" +
                ">  <Saltdata>\n" +
                "Free Base\n" +
                "\n" +
                ">  <Information>\n" +
                "Valrubicin is a chemotherapy agent, inhibits TPA- and PDBu-induced PKC activation with IC50s of 0.85 and 1.25 ¶ÃM, respectively, and has antitumor and antiinflammatory activity.\n" +
                "\n" +
                ">  <Smiles>\n" +
                "CCCCC(OCC([C@]1(O)CC2=C(C(O)=C3C(C4=C(C(C3=C2O)=O)C=CC=C4OC)=O)[C@@H](O[C@H]5C[C@H](NC(C(F)(F)F)=O)[C@H](O)[C@H](C)O5)C1)=O)=O\n" +
                "\n" +
                ">  <Solubility>\n" +
                "DMSO : °› 130 mg/mL (179.65 mM); H2O : < 0.1 mg/mL (insoluble)\n" +
                "\n" +
                ">  <Solvent>\n" +
                "EtOH\n" +
                "\n" +
                ">  <Batch No.>\n" +
                "34233\n" +
                "\n" +
                ">  <Quantity>\n" +
                "0.010000000\n" +
                "\n" +
                ">  <URL>\n" +
                "https://www.medchemexpress.com/Valrubicin.html\n" +
                "\n" +
                ">  <Pathway>\n" +
                "Epigenetics; TGF-beta/Smad\n" +
                "\n" +
                ">  <SUPPLIER>\n" +
                "MedChemExpress\n" +
                "\n" +
                "$$$$\n" +
                "Untitled Document\n" +
                "  ChemDraw03061715502D\n" +
                "\n" +
                " 31 33  0  0  0  0  0  0  0  0999 V2000\n" +
                "   -1.9887    1.6660    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -1.9887    0.8410    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -1.2743    0.4285    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.5598    0.8410    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.5598    1.6660    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -1.2743    2.0785    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -2.7032    2.0785    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -3.4177    1.6660    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -4.1321    2.0785    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -4.8466    1.6660    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -4.1321    2.9035    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -3.4177    0.8410    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -4.1321    0.4285    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -4.8466    0.8410    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.1547    0.4285    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.1547   -0.3965    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.8692   -0.8090    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.8692   -1.6340    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.2017   -2.1189    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.4567   -2.9035    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    1.2817   -2.9035    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    1.5366   -2.1189    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.5829   -1.8640    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    2.3212   -1.8640    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    2.9343   -2.4160    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    3.7189   -2.1611    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    3.8905   -1.3541    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    3.2774   -0.8021    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    2.4927   -1.0570    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    4.6751   -1.0991    0.0000 S   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    4.8466   -0.2922    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "  1  2  2  0      \n" +
                "  2  3  1  0      \n" +
                "  3  4  2  0      \n" +
                "  4  5  1  0      \n" +
                "  5  6  2  0      \n" +
                "  6  1  1  0      \n" +
                "  1  7  1  0      \n" +
                "  7  8  1  0      \n" +
                "  8  9  1  0      \n" +
                "  9 10  1  0      \n" +
                "  9 11  2  0      \n" +
                "  8 12  1  6      \n" +
                " 12 13  1  0      \n" +
                " 13 14  1  0      \n" +
                "  4 15  1  0      \n" +
                " 15 16  1  0      \n" +
                " 16 17  1  0      \n" +
                " 17 18  1  0      \n" +
                " 18 19  1  0      \n" +
                " 19 20  2  0      \n" +
                " 20 21  1  0      \n" +
                " 21 22  2  0      \n" +
                " 22 18  1  0      \n" +
                " 19 23  1  0      \n" +
                " 22 24  1  0      \n" +
                " 24 25  2  0      \n" +
                " 25 26  1  0      \n" +
                " 26 27  2  0      \n" +
                " 27 28  1  0      \n" +
                " 28 29  2  0      \n" +
                " 29 24  1  0      \n" +
                " 27 30  1  0      \n" +
                " 30 31  1  0      \n" +
                "M  END\n" +
                "\n" +
                "\n" +
                ">  <RackCode>\n" +
                "HYCPK4191\n" +
                "\n" +
                ">  <Cat. No.>\n" +
                "HY-19937\n" +
                "\n" +
                ">  <Product Name>\n" +
                "Saroglitazar\n" +
                "\n" +
                ">  <ROW>\n" +
                "A\n" +
                "\n" +
                ">  <COLUMN>\n" +
                "2\n" +
                "\n" +
                ">  <VialCode>\n" +
                "000003UCP\n" +
                "\n" +
                ">  <CAS No.>\n" +
                "495399-09-2\n" +
                ">  <Target>\n" +
                "PPAR\n" +
                "\n" +
                ">  <Saltdata>\n" +
                "Free Acid\n" +
                "\n" +
                ">  <Information>\n" +
                "Saroglitazar is a novel peroxisome proliferator-activated receptor (PPAR) agonist with predominant PPAR¶¡ and moderate PPAR¶√ activity with EC50 values of 0.65 pM and 3 nM in HepG2 cells, respectively.\n" +
                "\n" +
                ">  <Smiles>\n" +
                "OC([C@@H](OCC)CC1=CC=C(OCCN2C(C)=CC=C2C3=CC=C(SC)C=C3)C=C1)=O\n" +
                "\n" +
                ">  <Solubility>\n" +
                "DMSO : °› 25 mg/mL (56.87 mM); H2O : < 0.1 mg/mL (insoluble)\n" +
                "\n" +
                ">  <Solvent>\n" +
                "EtOH\n" +
                "\n" +
                ">  <Batch No.>\n" +
                "28096\n" +
                "\n" +
                ">  <Quantity>\n" +
                "0.010000000\n" +
                "\n" +
                ">  <URL>\n" +
                "https://www.medchemexpress.com/Saroglitazar.html\n" +
                "\n" +
                ">  <Pathway>\n" +
                "Cell Cycle/DNA Damage\n" +
                "\n" +
                ">  <SUPPLIER>\n" +
                "MedChemExpress\n" +
                "\n" +
                "$$$$";



        String expected = "Untitled Document\n" +
                "  ChemDraw05101917272D\n" +
                "\n" +
                " 51 55  0  0  0  0  0  0  0  0999 V2000\n" +
                "    5.7158   -1.6500    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    5.0013   -2.0625    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    4.2868   -1.6500    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    3.5724   -2.0625    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    2.8579   -1.6500    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    2.1434   -2.0625    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    1.4289   -1.6500    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.7145   -2.0625    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.0000   -1.6500    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.0000   -2.4750    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.7145   -2.0625    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -1.4289   -1.6500    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -1.4289   -0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -2.1434   -0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -2.1434    0.4125    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -2.8579   -0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -3.5724   -0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -4.2868   -0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -4.2868   -1.6500    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -3.5724   -2.0625    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -2.8579   -1.6500    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -2.1434   -2.0625    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -2.1434   -2.8875    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -3.5724   -2.8875    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -5.0013   -2.0625    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -5.7158   -1.6500    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -5.7158   -0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -5.0013   -0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -5.0013    0.4125    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -5.7158    0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -3.5724    0.4125    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.7145   -0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.7145    0.4125    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.0000    0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.7145    0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    1.4289    0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    2.1434    0.4125    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    2.8579    0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    3.5724    0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    3.5724   -0.4125    0.0000 F   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    4.2868    0.0000    0.0000 F   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    4.2868    0.8250    0.0000 F   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    2.8579    1.6500    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    1.4289    1.6500    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    2.1434    2.0625    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.7145    2.0625    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.7145    2.8875    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.0000    1.6500    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.0000   -0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.7145   -2.8875    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    2.8579   -0.8250    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "  1  2  1  0      \n" +
                "  2  3  1  0      \n" +
                "  3  4  1  0      \n" +
                "  4  5  1  0      \n" +
                "  5  6  1  0      \n" +
                "  6  7  1  0      \n" +
                "  7  8  1  0      \n" +
                "  8  9  1  0      \n" +
                "  9 10  1  1      \n" +
                "  9 11  1  0      \n" +
                " 11 12  1  0      \n" +
                " 12 13  2  0      \n" +
                " 13 14  1  0      \n" +
                " 14 15  1  0      \n" +
                " 14 16  2  0      \n" +
                " 16 17  1  0      \n" +
                " 17 18  1  0      \n" +
                " 18 19  2  0      \n" +
                " 19 20  1  0      \n" +
                " 20 21  1  0      \n" +
                " 16 21  1  0      \n" +
                " 21 22  2  0      \n" +
                " 12 22  1  0      \n" +
                " 22 23  1  0      \n" +
                " 20 24  2  0      \n" +
                " 19 25  1  0      \n" +
                " 25 26  2  0      \n" +
                " 26 27  1  0      \n" +
                " 27 28  2  0      \n" +
                " 18 28  1  0      \n" +
                " 28 29  1  0      \n" +
                " 29 30  1  0      \n" +
                " 17 31  2  0      \n" +
                " 13 32  1  0      \n" +
                " 32 33  1  1      \n" +
                " 34 33  1  6      \n" +
                " 34 35  1  0      \n" +
                " 35 36  1  0      \n" +
                " 36 37  1  1      \n" +
                " 37 38  1  0      \n" +
                " 38 39  1  0      \n" +
                " 39 40  1  0      \n" +
                " 39 41  1  0      \n" +
                " 39 42  1  0      \n" +
                " 38 43  2  0      \n" +
                " 36 44  1  0      \n" +
                " 44 45  1  1      \n" +
                " 44 46  1  0      \n" +
                " 46 47  1  1      \n" +
                " 46 48  1  0      \n" +
                " 34 48  1  0      \n" +
                " 32 49  1  0      \n" +
                "  9 49  1  0      \n" +
                "  8 50  2  0      \n" +
                "  5 51  2  0      \n" +
                "M  END\n" +
                ">  <RackCode>\n" +
                "HYCPK4191\n" +
                "\n" +
                ">  <Cat. No.>\n" +
                "HY-13772\n" +
                "\n" +
                ">  <Product Name>\n" +
                "Valrubicin\n" +
                "\n" +
                ">  <ROW>\n" +
                "A\n" +
                "\n" +
                ">  <COLUMN>\n" +
                "1\n" +
                "\n" +
                ">  <VialCode>\n" +
                "000003UJT\n" +
                "\n" +
                ">  <CAS No.>\n" +
                "56124-62-0\n" +
                ">  <Target>\n" +
                "PKC\n" +
                "\n" +
                ">  <Saltdata>\n" +
                "Free Base\n" +
                "\n" +
                ">  <Information>\n" +
                "Valrubicin is a chemotherapy agent, inhibits TPA- and PDBu-induced PKC activation with IC50s of 0.85 and 1.25 ¶ÃM, respectively, and has antitumor and antiinflammatory activity.\n" +
                "\n" +
                ">  <Smiles>\n" +
                "CCCCC(OCC([C@]1(O)CC2=C(C(O)=C3C(C4=C(C(C3=C2O)=O)C=CC=C4OC)=O)[C@@H](O[C@H]5C[C@H](NC(C(F)(F)F)=O)[C@H](O)[C@H](C)O5)C1)=O)=O\n" +
                "\n" +
                ">  <Solubility>\n" +
                "DMSO : °› 130 mg/mL (179.65 mM); H2O : < 0.1 mg/mL (insoluble)\n" +
                "\n" +
                ">  <Solvent>\n" +
                "EtOH\n" +
                "\n" +
                ">  <Batch No.>\n" +
                "34233\n" +
                "\n" +
                ">  <Quantity>\n" +
                "0.010000000\n" +
                "\n" +
                ">  <URL>\n" +
                "https://www.medchemexpress.com/Valrubicin.html\n" +
                "\n" +
                ">  <Pathway>\n" +
                "Epigenetics; TGF-beta/Smad\n" +
                "\n" +
                ">  <SUPPLIER>\n" +
                "MedChemExpress\n" +
                "\n" +
                "$$$$\n" +
                "Untitled Document\n" +
                "  ChemDraw03061715502D\n" +
                "\n" +
                " 31 33  0  0  0  0  0  0  0  0999 V2000\n" +
                "   -1.9887    1.6660    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -1.9887    0.8410    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -1.2743    0.4285    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.5598    0.8410    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.5598    1.6660    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -1.2743    2.0785    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -2.7032    2.0785    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -3.4177    1.6660    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -4.1321    2.0785    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -4.8466    1.6660    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -4.1321    2.9035    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -3.4177    0.8410    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -4.1321    0.4285    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -4.8466    0.8410    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.1547    0.4285    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.1547   -0.3965    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.8692   -0.8090    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.8692   -1.6340    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.2017   -2.1189    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.4567   -2.9035    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    1.2817   -2.9035    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    1.5366   -2.1189    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.5829   -1.8640    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    2.3212   -1.8640    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    2.9343   -2.4160    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    3.7189   -2.1611    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    3.8905   -1.3541    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    3.2774   -0.8021    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    2.4927   -1.0570    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    4.6751   -1.0991    0.0000 S   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    4.8466   -0.2922    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "  1  2  2  0      \n" +
                "  2  3  1  0      \n" +
                "  3  4  2  0      \n" +
                "  4  5  1  0      \n" +
                "  5  6  2  0      \n" +
                "  6  1  1  0      \n" +
                "  1  7  1  0      \n" +
                "  7  8  1  0      \n" +
                "  8  9  1  0      \n" +
                "  9 10  1  0      \n" +
                "  9 11  2  0      \n" +
                "  8 12  1  6      \n" +
                " 12 13  1  0      \n" +
                " 13 14  1  0      \n" +
                "  4 15  1  0      \n" +
                " 15 16  1  0      \n" +
                " 16 17  1  0      \n" +
                " 17 18  1  0      \n" +
                " 18 19  1  0      \n" +
                " 19 20  2  0      \n" +
                " 20 21  1  0      \n" +
                " 21 22  2  0      \n" +
                " 22 18  1  0      \n" +
                " 19 23  1  0      \n" +
                " 22 24  1  0      \n" +
                " 24 25  2  0      \n" +
                " 25 26  1  0      \n" +
                " 26 27  2  0      \n" +
                " 27 28  1  0      \n" +
                " 28 29  2  0      \n" +
                " 29 24  1  0      \n" +
                " 27 30  1  0      \n" +
                " 30 31  1  0      \n" +
                "M  END\n" +
                ">  <RackCode>\n" +
                "HYCPK4191\n" +
                "\n" +
                ">  <Cat. No.>\n" +
                "HY-19937\n" +
                "\n" +
                ">  <Product Name>\n" +
                "Saroglitazar\n" +
                "\n" +
                ">  <ROW>\n" +
                "A\n" +
                "\n" +
                ">  <COLUMN>\n" +
                "2\n" +
                "\n" +
                ">  <VialCode>\n" +
                "000003UCP\n" +
                "\n" +
                ">  <CAS No.>\n" +
                "495399-09-2\n" +
                ">  <Target>\n" +
                "PPAR\n" +
                "\n" +
                ">  <Saltdata>\n" +
                "Free Acid\n" +
                "\n" +
                ">  <Information>\n" +
                "Saroglitazar is a novel peroxisome proliferator-activated receptor (PPAR) agonist with predominant PPAR¶¡ and moderate PPAR¶√ activity with EC50 values of 0.65 pM and 3 nM in HepG2 cells, respectively.\n" +
                "\n" +
                ">  <Smiles>\n" +
                "OC([C@@H](OCC)CC1=CC=C(OCCN2C(C)=CC=C2C3=CC=C(SC)C=C3)C=C1)=O\n" +
                "\n" +
                ">  <Solubility>\n" +
                "DMSO : °› 25 mg/mL (56.87 mM); H2O : < 0.1 mg/mL (insoluble)\n" +
                "\n" +
                ">  <Solvent>\n" +
                "EtOH\n" +
                "\n" +
                ">  <Batch No.>\n" +
                "28096\n" +
                "\n" +
                ">  <Quantity>\n" +
                "0.010000000\n" +
                "\n" +
                ">  <URL>\n" +
                "https://www.medchemexpress.com/Saroglitazar.html\n" +
                "\n" +
                ">  <Pathway>\n" +
                "Cell Cycle/DNA Damage\n" +
                "\n" +
                ">  <SUPPLIER>\n" +
                "MedChemExpress\n" +
                "\n" +
                "$$$$";

        assertCleanedCorrectly(expected, sdf);

    }

    @Test
    public void tooManyMolfileEndsGetCleanedToOne() throws Exception {
        String extraEnd="\n" +
                "   JSDraw212191818162D\n" +
                "\n" +
                " 10 11  0  0  0  0            999 V2000\n" +
                "   16.7960   -5.3560    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   15.4450   -4.5760    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   15.4450   -3.0160    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   16.7960   -2.2360    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   18.1470   -3.0160    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   18.1470   -4.5760    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   19.4980   -5.3560    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   20.8490   -4.5760    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   20.8490   -3.0160    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   19.4980   -2.2360    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "  1  2  1  0  0  0  0\n" +
                "  2  3  1  0  0  0  0\n" +
                "  3  4  1  0  0  0  0\n" +
                "  4  5  1  0  0  0  0\n" +
                "  5  6  1  0  0  0  0\n" +
                "  6  1  1  0  0  0  0\n" +
                "  6  7  1  0  0  0  0\n" +
                "  7  8  1  0  0  0  0\n" +
                "  8  9  1  0  0  0  0\n" +
                "  9 10  1  0  0  0  0\n" +
                " 10  5  1  0  0  0  0\n" +
                "M  ENDM  END";
        String expected="\n" +
                "   JSDraw212191818162D\n" +
                "\n" +
                " 10 11  0  0  0  0            999 V2000\n" +
                "   16.7960   -5.3560    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   15.4450   -4.5760    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   15.4450   -3.0160    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   16.7960   -2.2360    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   18.1470   -3.0160    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   18.1470   -4.5760    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   19.4980   -5.3560    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   20.8490   -4.5760    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   20.8490   -3.0160    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   19.4980   -2.2360    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "  1  2  1  0  0  0  0\n" +
                "  2  3  1  0  0  0  0\n" +
                "  3  4  1  0  0  0  0\n" +
                "  4  5  1  0  0  0  0\n" +
                "  5  6  1  0  0  0  0\n" +
                "  6  1  1  0  0  0  0\n" +
                "  6  7  1  0  0  0  0\n" +
                "  7  8  1  0  0  0  0\n" +
                "  8  9  1  0  0  0  0\n" +
                "  9 10  1  0  0  0  0\n" +
                " 10  5  1  0  0  0  0\n" +
                "M  END";
        assertCleanedCorrectly(expected, extraEnd);

    }

    @Test
    public void tooManyChargesOnOneLine() throws Exception {
        String molfileWithTooManyChargesOnOneLine="\n" +
                "   JSDraw212191818162D\n" +
                "\n" +
                " 10 11  0  0  0  0            999 V2000\n" +
                "   16.7960   -5.3560    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   15.4450   -4.5760    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   15.4450   -3.0160    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   16.7960   -2.2360    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   18.1470   -3.0160    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   18.1470   -4.5760    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   19.4980   -5.3560    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   20.8490   -4.5760    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   20.8490   -3.0160    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   19.4980   -2.2360    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "  1  2  1  0  0  0  0\n" +
                "  2  3  1  0  0  0  0\n" +
                "  3  4  1  0  0  0  0\n" +
                "  4  5  1  0  0  0  0\n" +
                "  5  6  1  0  0  0  0\n" +
                "  6  1  1  0  0  0  0\n" +
                "  6  7  1  0  0  0  0\n" +
                "  7  8  1  0  0  0  0\n" +
                "  8  9  1  0  0  0  0\n" +
                "  9 10  1  0  0  0  0\n" +
                " 10  5  1  0  0  0  0\n" +
                "M  CHG 10   1   1   2   1   3   1   4   1   5   1   6   1   7   1   8   1   9   1  10   1\n" +
                "M  END";
        String expected="\n" +
                "   JSDraw212191818162D\n" +
                "\n" +
                " 10 11  0  0  0  0            999 V2000\n" +
                "   16.7960   -5.3560    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   15.4450   -4.5760    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   15.4450   -3.0160    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   16.7960   -2.2360    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   18.1470   -3.0160    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   18.1470   -4.5760    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   19.4980   -5.3560    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   20.8490   -4.5760    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   20.8490   -3.0160    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   19.4980   -2.2360    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "  1  2  1  0  0  0  0\n" +
                "  2  3  1  0  0  0  0\n" +
                "  3  4  1  0  0  0  0\n" +
                "  4  5  1  0  0  0  0\n" +
                "  5  6  1  0  0  0  0\n" +
                "  6  1  1  0  0  0  0\n" +
                "  6  7  1  0  0  0  0\n" +
                "  7  8  1  0  0  0  0\n" +
                "  8  9  1  0  0  0  0\n" +
                "  9 10  1  0  0  0  0\n" +
                " 10  5  1  0  0  0  0\n" +
                "M  CHG  8   1   1   2   1   3   1   4   1   5   1   6   1   7   1   8   1\n" +
                "M  CHG  2   9   1  10   1\n" +
                "M  END";
        assertCleanedCorrectly(expected, molfileWithTooManyChargesOnOneLine);

    }

    @Test
    public void moreThan31ChargesStillGetsCleaned() throws IOException{
        String moreThan31Charges="\n" +
                "   JSDraw212191818462D\n" +
                "\n" +
                " 36 35  0  0  0  0            999 V2000\n" +
                "    4.4200   -6.5520    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "    5.7710   -7.3320    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "    7.1220   -6.5520    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "    8.4730   -7.3320    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "    9.8240   -6.5520    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   11.1750   -7.3320    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   12.5260   -6.5520    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   13.8770   -7.3320    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   15.2280   -6.5520    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   16.5790   -7.3320    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   17.9300   -6.5520    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   19.2810   -7.3320    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   20.6320   -6.5520    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   21.9830   -7.3320    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   23.3340   -6.5520    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   24.6850   -7.3320    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   26.0360   -6.5520    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   27.3870   -7.3320    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   28.7380   -6.5520    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   30.0890   -7.3320    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   31.4400   -6.5520    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   32.7910   -7.3320    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   34.1420   -6.5520    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   35.4930   -7.3320    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   36.8440   -6.5520    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   38.1950   -7.3320    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   39.5460   -6.5520    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   40.8970   -7.3320    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   42.2480   -6.5520    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   43.5990   -7.3320    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   44.9500   -6.5520    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   46.3010   -7.3320    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   47.6520   -6.5520    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   49.0030   -7.3320    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   50.3540   -6.5520    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   51.7050   -7.3320    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "  1  2  1  0  0  0  0\n" +
                "  2  3  1  0  0  0  0\n" +
                "  3  4  1  0  0  0  0\n" +
                "  4  5  1  0  0  0  0\n" +
                "  5  6  1  0  0  0  0\n" +
                "  6  7  1  0  0  0  0\n" +
                "  7  8  1  0  0  0  0\n" +
                "  8  9  1  0  0  0  0\n" +
                "  9 10  1  0  0  0  0\n" +
                " 10 11  1  0  0  0  0\n" +
                " 11 12  1  0  0  0  0\n" +
                " 12 13  1  0  0  0  0\n" +
                " 13 14  1  0  0  0  0\n" +
                " 14 15  1  0  0  0  0\n" +
                " 15 16  1  0  0  0  0\n" +
                " 16 17  1  0  0  0  0\n" +
                " 17 18  1  0  0  0  0\n" +
                " 18 19  1  0  0  0  0\n" +
                " 19 20  1  0  0  0  0\n" +
                " 20 21  1  0  0  0  0\n" +
                " 21 22  1  0  0  0  0\n" +
                " 22 23  1  0  0  0  0\n" +
                " 23 24  1  0  0  0  0\n" +
                " 24 25  1  0  0  0  0\n" +
                " 25 26  1  0  0  0  0\n" +
                " 26 27  1  0  0  0  0\n" +
                " 27 28  1  0  0  0  0\n" +
                " 28 29  1  0  0  0  0\n" +
                " 29 30  1  0  0  0  0\n" +
                " 30 31  1  0  0  0  0\n" +
                " 31 32  1  0  0  0  0\n" +
                " 32 33  1  0  0  0  0\n" +
                " 33 34  1  0  0  0  0\n" +
                " 34 35  1  0  0  0  0\n" +
                " 35 36  1  0  0  0  0\n" +
                "M  CHG 36   1   1   2   1   3   1   4   1   5   1   6   1   7   1   8   1   9   1  10   1  11   1  12   1  13   1  14   1  15   1  16   1  17   1  18   1  19   1  20   1  21   1  22   1  23   1  24   1  25   1  26   1  27   1  28   1  29   1  30   1  31   1  32   1  33   1  34   1  35   1  36   1\n" +
                "M  END";

        String expected="\n" +
                "   JSDraw212191818462D\n" +
                "\n" +
                " 36 35  0  0  0  0            999 V2000\n" +
                "    4.4200   -6.5520    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "    5.7710   -7.3320    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "    7.1220   -6.5520    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "    8.4730   -7.3320    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "    9.8240   -6.5520    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   11.1750   -7.3320    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   12.5260   -6.5520    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   13.8770   -7.3320    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   15.2280   -6.5520    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   16.5790   -7.3320    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   17.9300   -6.5520    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   19.2810   -7.3320    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   20.6320   -6.5520    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   21.9830   -7.3320    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   23.3340   -6.5520    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   24.6850   -7.3320    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   26.0360   -6.5520    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   27.3870   -7.3320    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   28.7380   -6.5520    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   30.0890   -7.3320    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   31.4400   -6.5520    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   32.7910   -7.3320    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   34.1420   -6.5520    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   35.4930   -7.3320    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   36.8440   -6.5520    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   38.1950   -7.3320    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   39.5460   -6.5520    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   40.8970   -7.3320    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   42.2480   -6.5520    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   43.5990   -7.3320    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   44.9500   -6.5520    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   46.3010   -7.3320    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   47.6520   -6.5520    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   49.0030   -7.3320    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   50.3540   -6.5520    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "   51.7050   -7.3320    0.0000 C   0  3  0  0  0  0  0  0  0  0  0  0\n" +
                "  1  2  1  0  0  0  0\n" +
                "  2  3  1  0  0  0  0\n" +
                "  3  4  1  0  0  0  0\n" +
                "  4  5  1  0  0  0  0\n" +
                "  5  6  1  0  0  0  0\n" +
                "  6  7  1  0  0  0  0\n" +
                "  7  8  1  0  0  0  0\n" +
                "  8  9  1  0  0  0  0\n" +
                "  9 10  1  0  0  0  0\n" +
                " 10 11  1  0  0  0  0\n" +
                " 11 12  1  0  0  0  0\n" +
                " 12 13  1  0  0  0  0\n" +
                " 13 14  1  0  0  0  0\n" +
                " 14 15  1  0  0  0  0\n" +
                " 15 16  1  0  0  0  0\n" +
                " 16 17  1  0  0  0  0\n" +
                " 17 18  1  0  0  0  0\n" +
                " 18 19  1  0  0  0  0\n" +
                " 19 20  1  0  0  0  0\n" +
                " 20 21  1  0  0  0  0\n" +
                " 21 22  1  0  0  0  0\n" +
                " 22 23  1  0  0  0  0\n" +
                " 23 24  1  0  0  0  0\n" +
                " 24 25  1  0  0  0  0\n" +
                " 25 26  1  0  0  0  0\n" +
                " 26 27  1  0  0  0  0\n" +
                " 27 28  1  0  0  0  0\n" +
                " 28 29  1  0  0  0  0\n" +
                " 29 30  1  0  0  0  0\n" +
                " 30 31  1  0  0  0  0\n" +
                " 31 32  1  0  0  0  0\n" +
                " 32 33  1  0  0  0  0\n" +
                " 33 34  1  0  0  0  0\n" +
                " 34 35  1  0  0  0  0\n" +
                " 35 36  1  0  0  0  0\n" +
                "M  CHG  8   1   1   2   1   3   1   4   1   5   1   6   1   7   1   8   1\n" +
                "M  CHG  8   9   1  10   1  11   1  12   1  13   1  14   1  15   1  16   1\n" +
                "M  CHG  8  17   1  18   1  19   1  20   1  21   1  22   1  23   1  24   1\n" +
                "M  CHG  8  25   1  26   1  27   1  28   1  29   1  30   1  31   1  32   1\n" +
                "M  CHG  4  33   1  34   1  35   1  36   1\n" +
                "M  END";


        assertCleanedCorrectly(expected,moreThan31Charges);

    }

    @Test
    public void invalidSgroupTypes() throws IOException{
        String wrong = "\n  Marvin  04281710572D          \n\n" +
                " 24 22  0  0  0  0            999 V2000\n" +
                "    8.6634   -4.3278    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    8.2440   -5.0315    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    8.2562   -3.6159    0.0000 C   0  0  1  0  0  0  0  0  0  0  0  0\n" +
                "    8.6703   -2.9023    0.0000 C   0  0  2  0  0  0  0  0  0  0  0  0\n" +
                "    9.6413   -2.9023    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    9.0740   -2.1955    0.0000 H   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    8.2574   -2.1835    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    7.4364   -2.1835    0.0000 C   0  0  1  0  0  0  0  0  0  0  0  0\n" +
                "    7.0222   -2.8969    0.0000 C   0  0  2  0  0  0  0  0  0  0  0  0\n" +
                "    7.4294   -3.6159    0.0000 C   0  0  2  0  0  0  0  0  0  0  0  0\n" +
                "    7.0153   -4.3223    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    7.4186   -5.0314    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    6.1995   -2.8969    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    5.0253   -2.8969    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    7.0275   -1.4653    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    7.4324   -0.7521    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    8.2532   -0.7521    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    8.5760   -7.5493    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    7.8658   -7.1341    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    7.1557   -7.5446    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    6.4502   -7.1296    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    7.8658   -6.3134    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    7.2432   -9.2186    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    8.0688   -9.2186    0.0000 H   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "  8  7  1  0  0  0  0\n" +
                "  9  8  1  0  0  0  0\n" +
                " 10  9  1  0  0  0  0\n" +
                "  3 10  1  0  0  0  0\n" +
                " 10 11  1  1  0  0  0\n" +
                " 11 12  1  0  0  0  0\n" +
                "  9 13  1  6  0  0  0\n" +
                " 13 14  1  0  0  0  0\n" +
                "  8 15  1  1  0  0  0\n" +
                " 15 16  1  0  0  0  0\n" +
                " 16 17  1  0  0  0  0\n" +
                "  1  2  1  0  0  0  0\n" +
                "  3  1  1  6  0  0  0\n" +
                "  4  3  1  0  0  0  0\n" +
                "  4  5  1  0  0  0  0\n" +
                " 18 19  1  0  0  0  0\n" +
                " 19 20  1  0  0  0  0\n" +
                " 20 21  1  0  0  0  0\n" +
                " 19 22  2  0  0  0  0\n" +
                "  4  6  1  6  0  0  0\n" +
                "  7  4  1  0  0  0  0\n" +
                " 23 24  1  0  0  0  0\n" +
                "M  SPL  1   1   2\n" +
                "M  SDT   3 FDAREG_SGROUP                                         \n" +
                "M  SDD   3    10.0049   -8.1788    DA    ALL  1       5  \n" +
                "M  SED   3 R1\n" +
                "M  END";


        String expected = "\n  Marvin  04281710572D          \n\n" +
                " 24 22  0  0  0  0            999 V2000\n" +
                "    8.6634   -4.3278    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    8.2440   -5.0315    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    8.2562   -3.6159    0.0000 C   0  0  1  0  0  0  0  0  0  0  0  0\n" +
                "    8.6703   -2.9023    0.0000 C   0  0  2  0  0  0  0  0  0  0  0  0\n" +
                "    9.6413   -2.9023    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    9.0740   -2.1955    0.0000 H   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    8.2574   -2.1835    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    7.4364   -2.1835    0.0000 C   0  0  1  0  0  0  0  0  0  0  0  0\n" +
                "    7.0222   -2.8969    0.0000 C   0  0  2  0  0  0  0  0  0  0  0  0\n" +
                "    7.4294   -3.6159    0.0000 C   0  0  2  0  0  0  0  0  0  0  0  0\n" +
                "    7.0153   -4.3223    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    7.4186   -5.0314    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    6.1995   -2.8969    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    5.0253   -2.8969    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    7.0275   -1.4653    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    7.4324   -0.7521    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    8.2532   -0.7521    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    8.5760   -7.5493    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    7.8658   -7.1341    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    7.1557   -7.5446    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    6.4502   -7.1296    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    7.8658   -6.3134    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    7.2432   -9.2186    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    8.0688   -9.2186    0.0000 H   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "  8  7  1  0  0  0  0\n" +
                "  9  8  1  0  0  0  0\n" +
                " 10  9  1  0  0  0  0\n" +
                "  3 10  1  0  0  0  0\n" +
                " 10 11  1  1  0  0  0\n" +
                " 11 12  1  0  0  0  0\n" +
                "  9 13  1  6  0  0  0\n" +
                " 13 14  1  0  0  0  0\n" +
                "  8 15  1  1  0  0  0\n" +
                " 15 16  1  0  0  0  0\n" +
                " 16 17  1  0  0  0  0\n" +
                "  1  2  1  0  0  0  0\n" +
                "  3  1  1  6  0  0  0\n" +
                "  4  3  1  0  0  0  0\n" +
                "  4  5  1  0  0  0  0\n" +
                " 18 19  1  0  0  0  0\n" +
                " 19 20  1  0  0  0  0\n" +
                " 20 21  1  0  0  0  0\n" +
                " 19 22  2  0  0  0  0\n" +
                "  4  6  1  6  0  0  0\n" +
                "  7  4  1  0  0  0  0\n" +
                " 23 24  1  0  0  0  0\n" +
//                "M  SPL  1   1   2\n" +
//                "M  SDT   3 FDAREG_SGROUP                                         \n" +
//                "M  SDD   3    10.0049   -8.1788    DA    ALL  1       5  \n" +
//                "M  SED   3 R1\n" +
                "M  END";


        assertCleanedCorrectly(expected,wrong);
    }

    @Test
    public void missingFirstLine() throws IOException{

        String expected = "\n" +
                "  Marvin  10310613082D          \n" +
                "\n" +
                "  6  6  0  0  0  0            999 V2000\n" +
                "    0.7145   -0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.0000   -0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.7145    0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.0000    0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.7145   -0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.7145    0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "  2  1  2  0  0  0  0\n" +
                "  3  1  1  0  0  0  0\n" +
                "  4  3  2  0  0  0  0\n" +
                "  5  2  1  0  0  0  0\n" +
                "  6  4  1  0  0  0  0\n" +
                "  5  6  2  0  0  0  0\n" +
                "M  END";

        String missingFirstBlankLine =
                "  Marvin  10310613082D          \n" +
                "\n" +
                "  6  6  0  0  0  0            999 V2000\n" +
                "    0.7145   -0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.0000   -0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.7145    0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.0000    0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.7145   -0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.7145    0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "  2  1  2  0  0  0  0\n" +
                "  3  1  1  0  0  0  0\n" +
                "  4  3  2  0  0  0  0\n" +
                "  5  2  1  0  0  0  0\n" +
                "  6  4  1  0  0  0  0\n" +
                "  5  6  2  0  0  0  0\n" +
                "M  END";

        assertCleanedCorrectly(expected,missingFirstBlankLine);
    }

    @Test
    public void missingCommentLine() throws IOException{

        String expected = "\n" +
                "  Marvin  10310613082D          \n" +
                "\n" +
                "  6  6  0  0  0  0            999 V2000\n" +
                "    0.7145   -0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.0000   -0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.7145    0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.0000    0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.7145   -0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.7145    0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "  2  1  2  0  0  0  0\n" +
                "  3  1  1  0  0  0  0\n" +
                "  4  3  2  0  0  0  0\n" +
                "  5  2  1  0  0  0  0\n" +
                "  6  4  1  0  0  0  0\n" +
                "  5  6  2  0  0  0  0\n" +
                "M  END";

        String missingFirstBlankLine ="\n" +
                "  Marvin  10310613082D          \n" +
//                        "\n" +
                        "  6  6  0  0  0  0            999 V2000\n" +
                        "    0.7145   -0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                        "    0.0000   -0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                        "    0.7145    0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                        "    0.0000    0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                        "   -0.7145   -0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                        "   -0.7145    0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                        "  2  1  2  0  0  0  0\n" +
                        "  3  1  1  0  0  0  0\n" +
                        "  4  3  2  0  0  0  0\n" +
                        "  5  2  1  0  0  0  0\n" +
                        "  6  4  1  0  0  0  0\n" +
                        "  5  6  2  0  0  0  0\n" +
                        "M  END";

        assertCleanedCorrectly(expected,missingFirstBlankLine);
    }

    @Test
    public void missingFirstLineAndHasComment() throws IOException{

        String expected = "\n" +
                "  Marvin  10310613082D          \n" +
                "comment\n" +
                "  6  6  0  0  0  0            999 V2000\n" +
                "    0.7145   -0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.0000   -0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.7145    0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.0000    0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.7145   -0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.7145    0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "  2  1  2  0  0  0  0\n" +
                "  3  1  1  0  0  0  0\n" +
                "  4  3  2  0  0  0  0\n" +
                "  5  2  1  0  0  0  0\n" +
                "  6  4  1  0  0  0  0\n" +
                "  5  6  2  0  0  0  0\n" +
                "M  END";

        String missingFirstBlankLine =
//                "\n" +
                "  Marvin  10310613082D          \n" +
                "comment\n" +
                "  6  6  0  0  0  0            999 V2000\n" +
                "    0.7145   -0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.0000   -0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.7145    0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.0000    0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.7145   -0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.7145    0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "  2  1  2  0  0  0  0\n" +
                "  3  1  1  0  0  0  0\n" +
                "  4  3  2  0  0  0  0\n" +
                "  5  2  1  0  0  0  0\n" +
                "  6  4  1  0  0  0  0\n" +
                "  5  6  2  0  0  0  0\n" +
                "M  END";

        assertCleanedCorrectly(expected,missingFirstBlankLine);
    }

    @Test
    public void validWithCommentNoName() throws IOException{

        String expected = "\n" +
                "  Marvin  10310613082D          \n" +
                "comment\n" +
                "  6  6  0  0  0  0            999 V2000\n" +
                "    0.7145   -0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.0000   -0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.7145    0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.0000    0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.7145   -0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.7145    0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "  2  1  2  0  0  0  0\n" +
                "  3  1  1  0  0  0  0\n" +
                "  4  3  2  0  0  0  0\n" +
                "  5  2  1  0  0  0  0\n" +
                "  6  4  1  0  0  0  0\n" +
                "  5  6  2  0  0  0  0\n" +
                "M  END";

        String missingFirstBlankLine =
                "\n" +
                "  Marvin  10310613082D          \n" +
                        "comment\n" +
                        "  6  6  0  0  0  0            999 V2000\n" +
                        "    0.7145   -0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                        "    0.0000   -0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                        "    0.7145    0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                        "    0.0000    0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                        "   -0.7145   -0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                        "   -0.7145    0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                        "  2  1  2  0  0  0  0\n" +
                        "  3  1  1  0  0  0  0\n" +
                        "  4  3  2  0  0  0  0\n" +
                        "  5  2  1  0  0  0  0\n" +
                        "  6  4  1  0  0  0  0\n" +
                        "  5  6  2  0  0  0  0\n" +
                        "M  END";

        assertCleanedCorrectly(expected,missingFirstBlankLine);
    }

    @Test
    public void validWithCommentAndName() throws IOException{

        String expected = "Benzene\n" +
                "  Marvin  10310613082D          \n" +
                "comment\n" +
                "  6  6  0  0  0  0            999 V2000\n" +
                "    0.7145   -0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.0000   -0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.7145    0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.0000    0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.7145   -0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.7145    0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "  2  1  2  0  0  0  0\n" +
                "  3  1  1  0  0  0  0\n" +
                "  4  3  2  0  0  0  0\n" +
                "  5  2  1  0  0  0  0\n" +
                "  6  4  1  0  0  0  0\n" +
                "  5  6  2  0  0  0  0\n" +
                "M  END";

        String missingFirstBlankLine =
                "Benzene\n" +
                        "  Marvin  10310613082D          \n" +
                        "comment\n" +
                        "  6  6  0  0  0  0            999 V2000\n" +
                        "    0.7145   -0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                        "    0.0000   -0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                        "    0.7145    0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                        "    0.0000    0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                        "   -0.7145   -0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                        "   -0.7145    0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                        "  2  1  2  0  0  0  0\n" +
                        "  3  1  1  0  0  0  0\n" +
                        "  4  3  2  0  0  0  0\n" +
                        "  5  2  1  0  0  0  0\n" +
                        "  6  4  1  0  0  0  0\n" +
                        "  5  6  2  0  0  0  0\n" +
                        "M  END";

        assertCleanedCorrectly(expected,missingFirstBlankLine);
    }

    @Test
    public void missingCommentButHasName() throws IOException{

        String expected = "Benzene\n" +
                "  Marvin  10310613082D          \n" +
                "\n" +
                "  6  6  0  0  0  0            999 V2000\n" +
                "    0.7145   -0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.0000   -0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.7145    0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "    0.0000    0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.7145   -0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   -0.7145    0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "  2  1  2  0  0  0  0\n" +
                "  3  1  1  0  0  0  0\n" +
                "  4  3  2  0  0  0  0\n" +
                "  5  2  1  0  0  0  0\n" +
                "  6  4  1  0  0  0  0\n" +
                "  5  6  2  0  0  0  0\n" +
                "M  END";

        String missingFirstBlankLine =
                "Benzene\n" +
                        "  Marvin  10310613082D          \n" +
//                        "comment\n" +
                        "  6  6  0  0  0  0            999 V2000\n" +
                        "    0.7145   -0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                        "    0.0000   -0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                        "    0.7145    0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                        "    0.0000    0.8250    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                        "   -0.7145   -0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                        "   -0.7145    0.4125    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                        "  2  1  2  0  0  0  0\n" +
                        "  3  1  1  0  0  0  0\n" +
                        "  4  3  2  0  0  0  0\n" +
                        "  5  2  1  0  0  0  0\n" +
                        "  6  4  1  0  0  0  0\n" +
                        "  5  6  2  0  0  0  0\n" +
                        "M  END";

        assertCleanedCorrectly(expected,missingFirstBlankLine);
    }

    @Test
    public void removeParentAtomsIfSgroupIsntMUL() throws Exception{
        String mol = "\n\n  JSDraw207062014492D\n" +
                " 19 19  0  0  0  0              0 V2000\n" +
                "   34.7524  -11.8314    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   34.7524  -10.3407    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   33.4688   -9.6284    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   32.2293  -10.3407    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   30.8822   -9.5130    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   29.6100  -10.2950    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   28.2993   -9.2792    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   26.6430   -9.2792    0.0000 S   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   27.5017   -7.8487    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   25.4978   -8.5482    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   25.8524  -10.4985    0.0000 O   0  5  0  0  0  0  0  0  0  0  0  0\n" +
                "   20.7800  -17.9621    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   32.2293  -11.8314    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   33.5320  -12.5242    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   33.4688   -5.5321    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   36.0925   -9.4672    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   36.0925   -7.9686    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   36.0925  -12.6299    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   41.4798  -17.1579    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "  1  2  2  0  0  0  0\n" +
                "  2  3  1  0  0  0  0\n" +
                "  3  4  2  0  0  0  0\n" +
                "  4  5  1  0  0  0  0\n" +
                "  5  6  1  0  0  0  0\n" +
                "  6  7  1  0  0  0  0\n" +
                "  7  8  1  0  0  0  0\n" +
                "  8  9  2  0  0  0  0\n" +
                "  8 10  2  0  0  0  0\n" +
                "  8 11  1  0  0  0  0\n" +
                "  6 12  1  0  0  0  0\n" +
                " 13  4  1  0  0  0  0\n" +
                " 14 13  2  0  0  0  0\n" +
                "  1 14  1  0  0  0  0\n" +
                "  3 15  1  0  0  0  0\n" +
                "  2 16  1  0  0  0  0\n" +
                " 16 17  1  0  0  0  0\n" +
                "  1 18  1  0  0  0  0\n" +
                " 18 19  1  0  0  0  0\n" +
                "M  STY  1   1 SRU\n" +
                "M  SCN  1   1 HT \n" +
                "M  SAL   1  8   1   2   3   4   5   6   7   8\n" +
                "M  SAL   1  8   9  10  11  13  14  15  16  17\n" +
                "M  SAL   1  1  18\n" +
                "M  SBL   1  2  11  19\n" +
                "M  SMT   1 A\n" +
                "M  SPA   1  8   1   2   3   4   5   6   7   8\n" +
                "M  SPA   1  8   9  10  11  13  14  15  16  17\n" +
                "M  SPA   1  1  18\n" +
                "M  SDI   1  4   25.1727  -16.0952   25.1727  -12.8501\n" +
                "M  SDI   1  4   38.7614  -12.8501   38.7614  -16.0952\n" +
                "M  CHG  1  11  -1\n" +
                "M  END";

        String expected = "\n\n  JSDraw207062014492D\n" +
                " 19 19  0  0  0  0              0 V2000\n" +
                "   34.7524  -11.8314    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   34.7524  -10.3407    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   33.4688   -9.6284    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   32.2293  -10.3407    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   30.8822   -9.5130    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   29.6100  -10.2950    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   28.2993   -9.2792    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   26.6430   -9.2792    0.0000 S   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   27.5017   -7.8487    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   25.4978   -8.5482    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   25.8524  -10.4985    0.0000 O   0  5  0  0  0  0  0  0  0  0  0  0\n" +
                "   20.7800  -17.9621    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   32.2293  -11.8314    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   33.5320  -12.5242    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   33.4688   -5.5321    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   36.0925   -9.4672    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   36.0925   -7.9686    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   36.0925  -12.6299    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   41.4798  -17.1579    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "  1  2  2  0  0  0  0\n" +
                "  2  3  1  0  0  0  0\n" +
                "  3  4  2  0  0  0  0\n" +
                "  4  5  1  0  0  0  0\n" +
                "  5  6  1  0  0  0  0\n" +
                "  6  7  1  0  0  0  0\n" +
                "  7  8  1  0  0  0  0\n" +
                "  8  9  2  0  0  0  0\n" +
                "  8 10  2  0  0  0  0\n" +
                "  8 11  1  0  0  0  0\n" +
                "  6 12  1  0  0  0  0\n" +
                " 13  4  1  0  0  0  0\n" +
                " 14 13  2  0  0  0  0\n" +
                "  1 14  1  0  0  0  0\n" +
                "  3 15  1  0  0  0  0\n" +
                "  2 16  1  0  0  0  0\n" +
                " 16 17  1  0  0  0  0\n" +
                "  1 18  1  0  0  0  0\n" +
                " 18 19  1  0  0  0  0\n" +
                "M  STY  1   1 SRU\n" +
                "M  SCN  1   1 HT \n" +
                "M  SAL   1  8   1   2   3   4   5   6   7   8\n" +
                "M  SAL   1  8   9  10  11  13  14  15  16  17\n" +
                "M  SAL   1  1  18\n" +
                "M  SBL   1  2  11  19\n" +
                "M  SMT   1 A\n" +
//                "M  SPA   1  8   1   2   3   4   5   6   7   8\n" +
//                "M  SPA   1  8   9  10  11  13  14  15  16  17\n" +
//                "M  SPA   1  1  18\n" +
                "M  SDI   1  4   25.1727  -16.0952   25.1727  -12.8501\n" +
                "M  SDI   1  4   38.7614  -12.8501   38.7614  -16.0952\n" +
                "M  CHG  1  11  -1\n" +
                "M  END";

        assertCleanedCorrectly(expected,mol);

    }
    @Test
    public void fixNumberOfAtomsPerLine() throws Exception{
        String mol = "\n\nJSDraw207072011052D\n" +
                "\n" +
                " 24 22  0  0  1  0              0 V2000\n" +
                "   35.5107   -9.3320    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   34.7157  -10.6660    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   34.7387   -7.9820    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   35.5237   -6.6290    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   38.7251   -6.8438    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   36.2897   -5.2880    0.0000 H   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   34.7407   -5.2660    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   33.1837   -5.2660    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   32.3987   -6.6180    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   33.1707   -7.9820    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   32.3857   -9.3210    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   33.1507  -10.6660    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   30.8387   -6.6180    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   28.6127   -6.6180    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   32.4087   -3.9040    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   33.1767   -2.5510    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   34.7327   -2.5510    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   35.3447  -15.4400    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   33.9987  -14.6530    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   32.6517  -15.4310    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   31.3137  -14.6440    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   33.9987  -13.0970    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   32.8177  -18.6050    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   34.3837  -18.6050    0.0000 H   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "  8  7  1  0  0  0  0\n" +
                "  9  8  1  0  0  0  0\n" +
                " 10  9  1  0  0  0  0\n" +
                "  3 10  1  0  0  0  0\n" +
                " 10 11  1  1  0  0  0\n" +
                " 11 12  1  0  0  0  0\n" +
                "  9 13  1  6  0  0  0\n" +
                " 13 14  1  0  0  0  0\n" +
                "  8 15  1  1  0  0  0\n" +
                " 15 16  1  0  0  0  0\n" +
                " 16 17  1  0  0  0  0\n" +
                "  1  2  1  0  0  0  0\n" +
                "  3  1  1  6  0  0  0\n" +
                "  4  3  1  0  0  0  0\n" +
                "  4  5  1  0  0  0  0\n" +
                " 18 19  1  0  0  0  0\n" +
                " 19 20  1  0  0  0  0\n" +
                " 20 21  1  0  0  0  0\n" +
                " 19 22  2  0  0  0  0\n" +
                "  4  6  1  6  0  0  0\n" +
                "  7  4  1  0  0  0  0\n" +
                " 23 24  1  0  0  0  0\n" +
                "M  STY  1   1 SRU\n" +
                "M  SAL   1  17   1   2   3   4   6   7   8   9  10  11  12  13  15  16  17  23  24\n" +
                "M  SBL   1  2   8  15\n" +
                "M  SMT   1 A\n" +
                "M  SDI   1  4   30.0427  -19.4020   30.0427   -1.7550\n" +
                "M  SDI   1  4   37.0857   -1.7550   37.0857  -19.4020\n" +
                "M  END";

        String expected = "\n\nJSDraw207072011052D\n" +
                "\n" +
                " 24 22  0  0  1  0              0 V2000\n" +
                "   35.5107   -9.3320    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   34.7157  -10.6660    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   34.7387   -7.9820    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   35.5237   -6.6290    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   38.7251   -6.8438    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   36.2897   -5.2880    0.0000 H   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   34.7407   -5.2660    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   33.1837   -5.2660    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   32.3987   -6.6180    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   33.1707   -7.9820    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   32.3857   -9.3210    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   33.1507  -10.6660    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   30.8387   -6.6180    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   28.6127   -6.6180    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   32.4087   -3.9040    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   33.1767   -2.5510    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   34.7327   -2.5510    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   35.3447  -15.4400    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   33.9987  -14.6530    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   32.6517  -15.4310    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   31.3137  -14.6440    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   33.9987  -13.0970    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   32.8177  -18.6050    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   34.3837  -18.6050    0.0000 H   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "  8  7  1  0  0  0  0\n" +
                "  9  8  1  0  0  0  0\n" +
                " 10  9  1  0  0  0  0\n" +
                "  3 10  1  0  0  0  0\n" +
                " 10 11  1  1  0  0  0\n" +
                " 11 12  1  0  0  0  0\n" +
                "  9 13  1  6  0  0  0\n" +
                " 13 14  1  0  0  0  0\n" +
                "  8 15  1  1  0  0  0\n" +
                " 15 16  1  0  0  0  0\n" +
                " 16 17  1  0  0  0  0\n" +
                "  1  2  1  0  0  0  0\n" +
                "  3  1  1  6  0  0  0\n" +
                "  4  3  1  0  0  0  0\n" +
                "  4  5  1  0  0  0  0\n" +
                " 18 19  1  0  0  0  0\n" +
                " 19 20  1  0  0  0  0\n" +
                " 20 21  1  0  0  0  0\n" +
                " 19 22  2  0  0  0  0\n" +
                "  4  6  1  6  0  0  0\n" +
                "  7  4  1  0  0  0  0\n" +
                " 23 24  1  0  0  0  0\n" +
                "M  STY  1   1 SRU\n" +
                "M  SAL   1  8   1   2   3   4   6   7   8   9\n" +
                "M  SAL   1  8  10  11  12  13  15  16  17  23\n" +
                "M  SAL   1  1  24\n" +
                "M  SBL   1  2   8  15\n" +
                "M  SMT   1 A\n" +
                "M  SDI   1  4   30.0427  -19.4020   30.0427   -1.7550\n" +
                "M  SDI   1  4   37.0857   -1.7550   37.0857  -19.4020\n" +
                "M  END";

        assertCleanedCorrectly(expected,mol);

    }
    @Test
    public void removeParentAtomsIfSgroupIsntMUL2() throws Exception{
        String mol = "\n\nJSDraw207072011052D\n" +
                "\n" +
                " 24 22  0  0  1  0              0 V2000\n" +
                "   35.5107   -9.3320    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   34.7157  -10.6660    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   34.7387   -7.9820    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   35.5237   -6.6290    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   38.7251   -6.8438    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   36.2897   -5.2880    0.0000 H   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   34.7407   -5.2660    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   33.1837   -5.2660    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   32.3987   -6.6180    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   33.1707   -7.9820    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   32.3857   -9.3210    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   33.1507  -10.6660    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   30.8387   -6.6180    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   28.6127   -6.6180    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   32.4087   -3.9040    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   33.1767   -2.5510    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   34.7327   -2.5510    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   35.3447  -15.4400    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   33.9987  -14.6530    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   32.6517  -15.4310    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   31.3137  -14.6440    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   33.9987  -13.0970    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   32.8177  -18.6050    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   34.3837  -18.6050    0.0000 H   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "  8  7  1  0  0  0  0\n" +
                "  9  8  1  0  0  0  0\n" +
                " 10  9  1  0  0  0  0\n" +
                "  3 10  1  0  0  0  0\n" +
                " 10 11  1  1  0  0  0\n" +
                " 11 12  1  0  0  0  0\n" +
                "  9 13  1  6  0  0  0\n" +
                " 13 14  1  0  0  0  0\n" +
                "  8 15  1  1  0  0  0\n" +
                " 15 16  1  0  0  0  0\n" +
                " 16 17  1  0  0  0  0\n" +
                "  1  2  1  0  0  0  0\n" +
                "  3  1  1  6  0  0  0\n" +
                "  4  3  1  0  0  0  0\n" +
                "  4  5  1  0  0  0  0\n" +
                " 18 19  1  0  0  0  0\n" +
                " 19 20  1  0  0  0  0\n" +
                " 20 21  1  0  0  0  0\n" +
                " 19 22  2  0  0  0  0\n" +
                "  4  6  1  6  0  0  0\n" +
                "  7  4  1  0  0  0  0\n" +
                " 23 24  1  0  0  0  0\n" +
                "M  STY  1   1 SRU\n" +
                "M  SAL   1  8   1   2   3   4   6   7   8   9\n" +
                "M  SAL   1  8  10  11  12  13  15  16  17  23\n" +
                "M  SAL   1  1  24\n" +
                "M  SBL   1  2   8  15\n" +
                "M  SMT   1 A\n" +
                "M  SPA   1  8   1   2   3   4   6   7   8   9\n" +
                "M  SPA   1  8  10  11  12  13  15  16  17  23\n" +
                "M  SPA   1  1  24\n" +
                "M  SDI   1  4   30.0427  -19.4020   30.0427   -1.7550\n" +
                "M  SDI   1  4   37.0857   -1.7550   37.0857  -19.4020\n" +
                "M  END";

        String expected = "\n\nJSDraw207072011052D\n" +
                "\n" +
                " 24 22  0  0  1  0              0 V2000\n" +
                "   35.5107   -9.3320    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   34.7157  -10.6660    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   34.7387   -7.9820    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   35.5237   -6.6290    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   38.7251   -6.8438    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   36.2897   -5.2880    0.0000 H   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   34.7407   -5.2660    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   33.1837   -5.2660    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   32.3987   -6.6180    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   33.1707   -7.9820    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   32.3857   -9.3210    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   33.1507  -10.6660    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   30.8387   -6.6180    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   28.6127   -6.6180    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   32.4087   -3.9040    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   33.1767   -2.5510    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   34.7327   -2.5510    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   35.3447  -15.4400    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   33.9987  -14.6530    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   32.6517  -15.4310    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   31.3137  -14.6440    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   33.9987  -13.0970    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   32.8177  -18.6050    0.0000 *   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "   34.3837  -18.6050    0.0000 H   0  0  0  0  0  0  0  0  0  0  0  0\n" +
                "  8  7  1  0  0  0  0\n" +
                "  9  8  1  0  0  0  0\n" +
                " 10  9  1  0  0  0  0\n" +
                "  3 10  1  0  0  0  0\n" +
                " 10 11  1  1  0  0  0\n" +
                " 11 12  1  0  0  0  0\n" +
                "  9 13  1  6  0  0  0\n" +
                " 13 14  1  0  0  0  0\n" +
                "  8 15  1  1  0  0  0\n" +
                " 15 16  1  0  0  0  0\n" +
                " 16 17  1  0  0  0  0\n" +
                "  1  2  1  0  0  0  0\n" +
                "  3  1  1  6  0  0  0\n" +
                "  4  3  1  0  0  0  0\n" +
                "  4  5  1  0  0  0  0\n" +
                " 18 19  1  0  0  0  0\n" +
                " 19 20  1  0  0  0  0\n" +
                " 20 21  1  0  0  0  0\n" +
                " 19 22  2  0  0  0  0\n" +
                "  4  6  1  6  0  0  0\n" +
                "  7  4  1  0  0  0  0\n" +
                " 23 24  1  0  0  0  0\n" +
                "M  STY  1   1 SRU\n" +
                "M  SAL   1  8   1   2   3   4   6   7   8   9\n" +
                "M  SAL   1  8  10  11  12  13  15  16  17  23\n" +
                "M  SAL   1  1  24\n" +
                "M  SBL   1  2   8  15\n" +
                "M  SMT   1 A\n" +
//                "M  SPA   1  8   1   2   3   4   6   7   8   9\n" +
//                "M  SPA   1  8  10  11  12  13  15  16  17  23\n" +
//                "M  SPA   1  1  24\n" +
                "M  SDI   1  4   30.0427  -19.4020   30.0427   -1.7550\n" +
                "M  SDI   1  4   37.0857   -1.7550   37.0857  -19.4020\n" +
                "M  END";

        assertCleanedCorrectly(expected,mol);

    }
}
